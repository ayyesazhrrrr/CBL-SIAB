{% extends 'stock_prediction/base.html' %}

{% block title %}Prediksi Manual - SIAB{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card border-0" style="background:#fff; box-shadow:0 2px 8px rgba(34,54,168,0.06);">
            <div class="card-header" style="background:#2236a8; color:#fff; font-size:1.2rem; font-weight:600; border-radius:14px 14px 0 0;">
                <i class="bi bi-calculator"></i> Prediksi Manual
            </div>
            <div class="card-body p-4">
                <p class="mb-4" style="color:#2236a8; font-weight:500;">
                    Masukkan data saham untuk mendapatkan prediksi. Pastikan semua field diisi dengan benar.
                </p>
                <form method="post" autocomplete="off" style="max-width:820px; margin:auto;">
                    {% csrf_token %}
                    <style>
                    .input-pro {
                        border: 2px solid #2236a8 !important;
                        border-radius: 8px !important;
                        font-size: 1rem;
                        padding: 0.7rem 1rem;
                        background: #fff;
                        transition: border-color 0.2s, box-shadow 0.2s;
                        width: 100%;
                        max-width: 100%;
                        box-sizing: border-box;
                    }
                    .input-pro:focus {
                        border-color: #2236a8 !important;
                        box-shadow: 0 0 0 2px #2236a820;
                    }
                    .input-label {
                        font-size: 0.98rem;
                        color: #2236a8;
                        font-weight: 600;
                        margin-bottom: 0.2rem;
                    }
                    .input-helper {
                        font-size: 0.85rem;
                        color: #6b7280;
                        margin-top: 0.1rem;
                    }
                    .input-error {
                        font-size: 0.85rem;
                        color: #e53935;
                        margin-top: 0.1rem;
                    }
                    .input-row {
                        display: flex;
                        gap: 2rem;
                        margin-bottom: 1.2rem;
                        flex-wrap: wrap;
                    }
                    .input-col {
                        flex: 1 1 220px;
                        min-width: 180px;
                        max-width: 100%;
                        display: flex;
                        flex-direction: column;
                    }
                    @media (max-width: 900px) {
                        .input-row { gap: 1rem; }
                    }
                    @media (max-width: 700px) {
                        .input-row { flex-direction: column; gap: 0.5rem; }
                        .input-col { min-width: 100%; }
                    }
                    .form-action-row {
                        display: flex;
                        flex-wrap: wrap;
                        gap: 1rem;
                        justify-content: flex-end;
                    }
                    @media (max-width: 600px) {
                        .form-action-row { flex-direction: column; align-items: stretch; }
                        .form-action-row button, .form-action-row a { width: 100%; }
                    }
                    </style>

                    <div class="input-row">
                        <div class="input-col">
                            <label class="input-label">{{ form.open_price.label }}</label>
                            {{ form.open_price }}
                            <span class="input-helper">Harga pembukaan saham</span>
                            {% if form.open_price.errors %}<span class="input-error">{{ form.open_price.errors }}</span>{% endif %}
                        </div>
                        <div class="input-col">
                            <label class="input-label">{{ form.high_price.label }}</label>
                            {{ form.high_price }}
                            <span class="input-helper">Harga tertinggi</span>
                            {% if form.high_price.errors %}<span class="input-error">{{ form.high_price.errors }}</span>{% endif %}
                        </div>
                    </div>
                    <div class="input-row">
                        <div class="input-col">
                            <label class="input-label">{{ form.low_price.label }}</label>
                            {{ form.low_price }}
                            <span class="input-helper">Harga terendah</span>
                            {% if form.low_price.errors %}<span class="input-error">{{ form.low_price.errors }}</span>{% endif %}
                        </div>
                        <div class="input-col">
                            <label class="input-label">{{ form.close_price.label }}</label>
                            {{ form.close_price }}
                            <span class="input-helper">Harga penutupan</span>
                            {% if form.close_price.errors %}<span class="input-error">{{ form.close_price.errors }}</span>{% endif %}
                        </div>
                    </div>
                    <div class="input-row">
                        <div class="input-col">
                            <label class="input-label">{{ form.volume.label }}</label>
                            {{ form.volume }}
                            <span class="input-helper">Volume transaksi</span>
                            {% if form.volume.errors %}<span class="input-error">{{ form.volume.errors }}</span>{% endif %}
                        </div>
                    </div>

                    <hr class="my-4">
                    <h5 class="mb-3" style="color:#2236a8; font-weight:600;">Technical Indicators</h5>
                    <div class="input-row">
                        <div class="input-col">
                            <label class="input-label">{{ form.ma5.label }}</label>
                            {{ form.ma5 }}
                            <span class="input-helper">MA5 (Moving Average 5 hari)</span>
                            {% if form.ma5.errors %}<span class="input-error">{{ form.ma5.errors }}</span>{% endif %}
                        </div>
                        <div class="input-col">
                            <label class="input-label">{{ form.ma10.label }}</label>
                            {{ form.ma10 }}
                            <span class="input-helper">MA10 (Moving Average 10 hari)</span>
                            {% if form.ma10.errors %}<span class="input-error">{{ form.ma10.errors }}</span>{% endif %}
                        </div>
                    </div>
                    <div class="input-row">
                        <div class="input-col">
                            <label class="input-label">{{ form.return_value.label }}</label>
                            {{ form.return_value }}
                            <span class="input-helper">Return</span>
                            {% if form.return_value.errors %}<span class="input-error">{{ form.return_value.errors }}</span>{% endif %}
                        </div>
                        <div class="input-col">
                            <label class="input-label">{{ form.return_1.label }}</label>
                            {{ form.return_1 }}
                            <span class="input-helper">Return_1 (Previous Return)</span>
                            {% if form.return_1.errors %}<span class="input-error">{{ form.return_1.errors }}</span>{% endif %}
                        </div>
                        <div class="input-col">
                            <label class="input-label">{{ form.ma_diff.label }}</label>
                            {{ form.ma_diff }}
                            <span class="input-helper">MA Difference (MA5 - MA10)</span>
                            {% if form.ma_diff.errors %}<span class="input-error">{{ form.ma_diff.errors }}</span>{% endif %}
                        </div>
                    </div>

                    <div class="form-action-row mt-4">
                        <button type="submit" class="btn btn-primary px-4 py-2" style="font-size:1.1rem; font-weight:600;">
                            <i class="bi bi-graph-up"></i> Prediksi Sekarang
                        </button>
                        <a href="{% url 'stock_prediction:index' %}" class="btn btn-outline-secondary px-4 py-2" style="font-size:1.1rem;">
                            <i class="bi bi-arrow-left"></i> Kembali
                        </a>
                    </div>
                </form>
            </div>
        </div>

        <!-- Help Card -->
        <div class="card mt-4">
            <div class="card-body">
                <h6><i class="bi bi-info-circle text-primary"></i> Bantuan</h6>
                <p class="mb-0 small text-muted">
                    <strong>Tips:</strong> Jika Anda tidak memiliki nilai untuk technical indicators (MA5, MA10, Return,
                    dll),
                    Anda dapat menggunakan fitur <a href="{% url 'stock_prediction:predict_csv' %}">Upload CSV</a>
                    yang akan menghitung semua indicators secara otomatis.
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}